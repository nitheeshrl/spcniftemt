<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Past Requests</title>
  <link rel="stylesheet" href="style 3.css">
  <link rel="icon" href="white_logo.png" type="image/x-icon">
  <script type="text/javascript" src="app.js" defer></script>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" href="style 1.css" />
  <link rel="stylesheet" type="text/css" href="style 2.css">
 <style>
    table .approve{
       border-radius: 20px;
       padding: 10px;
       color: white;
       font-weight: bolder;
background-color: green;
margin-right: 20px;
text-decoration: none;
cursor: pointer;
}
table .decline{
border-radius: 20px;
padding: 10px;
color: white;
font-weight: bolder;
background-color: red;
margin-right: 20px;
text-decoration: none;
cursor: pointer;
}
.tablebee{
  width: 99%;
display: nonge;
}
.btn{
background-color:#182d8b;
margin-right: 20px;
text-decoration: none;
color: white;
border-radius: 20px;
padding: 20px;
cursor: pointer;
}
.btn1{
background-color:#182d8b;
height: 40px;
text-decoration: none;
color: white;
border-radius: 20px;
padding:12px;
cursor: pointer;
font-weight: bold;
}
</style>
<script>
  function logout(){
    updatelogstatus("Offline");  
    localStorage.removeItem("loggedname")
    window.location="../logout.html";
  }
  function userPopup(){
        console.log("ok")
document.getElementById("popup-4").classList.toggle("active");
}
function logoutPopup(){
        console.log("ok")
document.getElementById("popup-3").classList.toggle("active");

}
</script>
</head>
<body>
  <nav id="sidebar">
    <ul>
      <li class="indetails" id="insname">
        <div style="width: 50px; display: flex;gap: 10px;">
          <img style="width: 50px;" src="white_logo.png" alt="">
          <span style="color: white;">NIFTEM-T <br> Placement Cell</span>
        </div>
        
        <button onclick=toggleSidebar() id="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m313-480 155 156q11 11 11.5 27.5T468-268q-11 11-28 11t-28-11L228-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T468-692q11 11 11 28t-11 28L313-480Zm264 0 155 156q11 11 11.5 27.5T732-268q-11 11-28 11t-28-11L492-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T732-692q11 11 11 28t-11 28L577-480Z"/></svg>
        </button>
      </li>
      <li class="outdetails" id="outlogo" style="">
        <button class="out-items" onclick=toggleSidebar1() id="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m313-480 155 156q11 11 11.5 27.5T468-268q-11 11-28 11t-28-11L228-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T468-692q11 11 11 28t-11 28L313-480Zm264 0 155 156q11 11 11.5 27.5T732-268q-11 11-28 11t-28-11L492-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T732-692q11 11 11 28t-11 28L577-480Z"/></svg>
        </button>
        <img class="out-items" style="width: 50px;" src="white_logo.png" alt="">
        <img id="profileimage1" style=" scale:90%;border-radius: 50px; width: 50px; height: 50px;object-fit: cover; " src=".//1.png" alt="" srcset="">
       
      </li>
      <li class="indetails"  id="insprofile" style="left: 0px;">
        <div class="log-items" style="flex-direction: column; gap: 0px; align-items: center;justify-content: center;">
         <a onclick="userPopup()"><img id="profileimage" style=" scale:200%;border-radius: 50px; width: 50px; height: 50px; object-fit: cover;" src=".//1.png" alt="" srcset=""></a>
       <div style="background-color: white; color: black; padding: 10px;border-radius: 40px;">
        <p ><span id="mname">Nitheesh R L</span></p>
       </div>
       

          </div>

      </li>
      <li>
        <a onclick="notavailable()">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M520-640v-160q0-17 11.5-28.5T560-840h240q17 0 28.5 11.5T840-800v160q0 17-11.5 28.5T800-600H560q-17 0-28.5-11.5T520-640ZM120-480v-320q0-17 11.5-28.5T160-840h240q17 0 28.5 11.5T440-800v320q0 17-11.5 28.5T400-440H160q-17 0-28.5-11.5T120-480Zm400 320v-320q0-17 11.5-28.5T560-520h240q17 0 28.5 11.5T840-480v320q0 17-11.5 28.5T800-120H560q-17 0-28.5-11.5T520-160Zm-400 0v-160q0-17 11.5-28.5T160-360h240q17 0 28.5 11.5T440-320v160q0 17-11.5 28.5T400-120H160q-17 0-28.5-11.5T120-160Zm80-360h160v-240H200v240Zm400 320h160v-240H600v240Zm0-480h160v-80H600v80ZM200-200h160v-80H200v80Zm160-320Zm240-160Zm0 240ZM360-280Z"/></svg>
          <span>Dashboard</span>
        </a>
      </li>
      <li>
        <button onclick=toggleSubMenu(this) class="dropdown-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h207q16 0 30.5 6t25.5 17l57 57h320q33 0 56.5 23.5T880-640v400q0 33-23.5 56.5T800-160H160Zm0-80h640v-400H447l-80-80H160v480Zm0 0v-480 480Zm400-160v40q0 17 11.5 28.5T600-320q17 0 28.5-11.5T640-360v-40h40q17 0 28.5-11.5T720-440q0-17-11.5-28.5T680-480h-40v-40q0-17-11.5-28.5T600-560q-17 0-28.5 11.5T560-520v40h-40q-17 0-28.5 11.5T480-440q0 17 11.5 28.5T520-400h40Z"/></svg>
          <span>Brochure Update</span>
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"/></svg>
        </button>
        <ul class="sub-menu show">
          <div>
            <li><a href="request-form.html">Request Form</a></li>
            <li class="active"><a href="past.html">Past Requests</a></li>
          </div>
        </ul>
      </li>
      <li>
        <a href="forms.html" class="dropdown-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m221-313 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-228q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm0-320 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-548q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm339 353q-17 0-28.5-11.5T520-320q0-17 11.5-28.5T560-360h280q17 0 28.5 11.5T880-320q0 17-11.5 28.5T840-280H560Zm0-320q-17 0-28.5-11.5T520-640q0-17 11.5-28.5T560-680h280q17 0 28.5 11.5T880-640q0 17-11.5 28.5T840-600H560Z"/></svg>
          <span>Forms</span>
     
        </a>
    
      </li>
      <li>
        <button onclick=toggleSubMenu(this) class="dropdown-btn">
          
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-240v-32q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v32q0 33-23.5 56.5T720-160H240q-33 0-56.5-23.5T160-240Zm80 0h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z"/></svg>
          <span>Profile</span>
 
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"/></svg>
        </button>
        <ul class="sub-menu">
          <div>
            <li><a href="change-pass-1.html">Change Password</a></li>
            <li><a onclick="passkey()">Create PassKey</a></li>
            <li><a onclick="logoutPopup()" >Logout</a></li>
          </div>
        </ul>
      </li>

    </ul>
  </nav>
  <main>
    <div class="container" onclick="closeAllSubMenus()">
      <main style="margin-top: 30px;" class="table" id="customers_table">
        <section class="table__header">

            <div class="input-group">
                <input  type="search" placeholder="Search..." >
                <img src="images/search.png" alt="">
            </div>

        </section>

       <section id="tablebee" class="tablebee">         
        <section  class="table__body" >

            <table>
 <table  id="tabdetails">
               </table>
          </table>
        </section>
    </section> 

    <section class="msg" >

        <h1 style="text-align: center;"></h1>
        <div   id="dfiled" style="align-content:normal; margin-left: 0px;margin-right: auto; margin-top: 30px;"><p style="text-align: left;">
            <div ></div> <span id = "status" style="color: black;"></span></p></div>
            </p>
            </section>
            <section style="height: 100px; display: flex;justify-content: center;">
      
            </section>
    </main>
    <div id="load" class="load" > 
        <div class="loader" id="loader"> 
      
          </div> 
          <div
            id="message"
          class="message"
          style="width: 350px;"
            ></div>
        </div>      
        <div class="popup1" id="popup-3">
 
          <div class="overlay"></div>
      
          <div class="content">
      
          <div class="close-btn" onclick="togglePopup3()">&times;</div>
      
          <h1 style="margin-top: 50px;">Are you sure to logout?</h1>
      
          <p style="margin-bottom: 40px;"> </p>
          <div >
              <input id="aid" type="hidden" value="">
      <a class="btn" id="apbt" onclick="logout()">Yes</a>
      <a class="btn" onclick="togglePopup3()">Cancel</a>
          </div>
          </div>
      
          </div>
          <div class="popup" id="popup-1">
 
            <div class="overlay"></div>
        
            <div class="content">
        
            <div class="close-btn" onclick="togglePopup()">&times;</div>
        
            <h1 style="margin-top: 50px;">Confirm Update Approval</h1>
        
            <p style="margin-bottom: 40px;">Are you sure you wish to approve the Brochure details update? </p>
            <div >
                <input id="aid" type="hidden" value="">
        <a class="btn" id="apbt" onclick="approve()">Confirm</a>
        <a class="btn" onclick="togglePopup()">Cancel</a>
            </div>
            </div>
        
            </div>
      <div class="popup" id="popup-2">
  
          <div class="overlay"></div>
      
          <div class="content" style="height:400px;">
      
          <div class="close-btn" onclick="togglePopup2()">&times;</div>
      
          <h1 style="margin-top: 50px;">Confirm Update Decline</h1>
      
          <p style="margin-bottom: 40px;">Are you sure you wish to decline the Brochure details update? </p>
          <div >
              <div class="form-element" style=" flex-direction: column;align-items: flex-start; width: 100%;margin-bottom: 40px;">
                  <span class="q" >Reason for decline</span>
                  <input type="text" name="Reason" id="Reason" style="width: 100%;" placeholder="Enter the reason" />
                  </div>
                  <input id="did" type="hidden" value="">
      <a class="btn" id="decbt" onclick="decline()" style="background-color: red;">Decline</a>
      <a class="btn" onclick="togglePopup2()">Cancel</a>
          </div>
          </div>
      
          </div>
    </div>
   
  </main>
  
</body>
<script src="https://unpkg.com/@simplewebauthn/browser/dist/bundle/index.umd.min.js"></script>
<script>
  var statusg = "";
    var porfilepicback = sessionStorage.getItem("backprofilepic");
  if (porfilepicback!==null){
    document.getElementById("profileimage").src = porfilepicback;
    document.getElementById("profileimage1").src = porfilepicback;
  }
    function notavailable(){
    alert("Not Available")
  }
const  GetUniqueID = () =>{
const uniqueID = localStorage.getItem("Passkey-uniqueID");
if (uniqueID == undefined){
const newUniqueID = crypto.randomUUID();

return [newUniqueID, "New"];
}
else {
return uniqueID;
}
}
async function passkey(){
           var passdevuniid =GetUniqueID();
           console.log(passdevuniid);
if (passdevuniid[1] ==  "New"){
statusg = "keying"
 document.getElementById("loader").style.display="block"; 
           document.getElementById("load").style.display="initial";
           document.getElementById("message").textContent="Registering PassKey....";
         
       var passkeysss ={};
var fetchurl = "https://passkey-5ev6.onrender.com";
       const { startRegistration, startAuthentication } = SimpleWebAuthnBrowser;
           const url = new URL(window.location)
           const username = localStorage.getItem("loggedname");
           var weburl = location.hostname;
           console.log(weburl)
           const response = await fetch(fetchurl+'/register-challenge', {
               method: 'POST',
               headers: {
                   'Content-Type': 'application/json'
               },
               body: JSON.stringify({ username, weburl })
           })

           const challengeResult = await response.json()
           const { options } = challengeResult // Server side challenge

           const authenticationResult = await startRegistration({optionsJSON: options})
           console.log(authenticationResult)

           var urlorigin= location.protocol+"//"+location.host;
           console.log(urlorigin)
           var create_passkey = await fetch(fetchurl+'/register-verify', {
               method: 'POST',
               headers: {
                   'Content-Type': 'application/json'
               },
               body: JSON.stringify({ username, cred: authenticationResult, challenge: options.challenge, devUniId:passdevuniid[0], weburl,urlorigin })
           })
           const create_passkeyResult = await create_passkey.json();
           console.log(create_passkeyResult.result)
           
           
passkeysss = create_passkeyResult.info;
console.log(create_passkeyResult.info);
if (create_passkeyResult.info.userVerified){
 localStorage.setItem("Passkey-uniqueID",passdevuniid[0]);
 document.getElementById("loader").style.display="none"; 
document.getElementById("message").textContent="PassKey Registered Successfully";
statusg="";
setTimeout(function () { 
 document.getElementById("load").style.display="none";
},2000);
}


}
else{
alert("PassKey is already created for this Device")
}
}
       function approvePopup(id){
           console.log("ok")
   document.getElementById("popup-1").classList.toggle("active");
   document.getElementById("aid").value = id;
   
   }

   function togglePopup(){
   document.getElementById("popup-1").classList.toggle("active");
   }
   function declinePopup(id){
       console.log("ok")
   document.getElementById("popup-2").classList.toggle("active");
   document.getElementById("did").value = id;
   
   }
   function togglePopup2(){
   document.getElementById("popup-2").classList.toggle("active");
   }
   function togglePopup3(){
   document.getElementById("popup-3").classList.toggle("active");
   }
   function togglePopup4(){
   document.getElementById("popup-4").classList.toggle("active");
   }
   var uorps = [
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'B.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'M.Tech',
'B.Tech',
'M.Tech'
   ]
   var inames = [
'Aarthi A',
'Aishwarya Lakshmi S',
'Ajitesh S',
'Akash B',
'Amirtha Varshini A',
'Anandha Keerthy M',
'Anindit Bizy Nair',
'Anusha R',
'Archana P',
'Avantika C',
'Chandrika Devendrappa',
'Chitturi Rohith',
'Cubarani Η',
'David Evander Jebson S',
'Dhanaselvam KR',
'Diana Celcia R',
'Diya Dharshini S',
'Ethaya D',
'Gautam Nayak',
'Ginu Robtus R',
'Guberavishnu S',
'Guguloth Sridhar',
'Himavanth R',
'Jegan P',
'Jenish Daniel B',
'Joshua Charles',
'K Kabilan',
'Karyamsetty Worship',
'Keerthika P',
'Kevin Francis',
'Kisha M',
'Kota Lakshmi Sanjana',
'Lakshmi Narayanan S',
'Lakshmi Sruthi L',
'Lavudya Sai Kumar',
'Mahabir Prasad Swain',
'Merla A P',
'Mohamed Tharif N J',
'Mohannath Shroff J',
'MA Monesh Ram',
'Mudavath Anjali',
'Muthuraja K',
'Nitheesh R L',
'Nithish J P',
'Padmaja M',
'Pranav Nanda Kishore',
'Punithavathi D',
'Rakshithapriya S',
'J Sanjeeth',
'Santhoshkumar P',
'Shivam Jha',
'Sivashree ',
'Sri Harini S',
'Srinithi C P',
'Srivatsan V',
'Subbu Krishna Sharma GM',
'Suman Kumar',
'Surendar S',
'Tippaleti Srujana',
'Vemula Uharika',
'Vishnu Varthan T',
'Yadla Ganesh Babu',
'Yuvashreekantham R',
'Anjali S',
'Anshida P K',
'Hari Priya J',
'Harish S',
'Hayanthika M S',
'Irfana Z',
'Kadimi Lakshmi Devi',
'Karthick Ajay B',
'Kolli Venkata Naga Mallikarjuna Reddy',
'Nandana M',
'Shaliha A',
'Sruti Chandra',
'Sushmithasri R',
'Abhijith K',
'Ishwarya Lakshmi S',
'Joseph P J',
'Mani Bharathi G',
'Manikandan T',
'Mathangi G',
'Mulukuri Naveena',
'Muthumeena J',
'Rajasri C',
'Shanmugapriya R',
'Srivigneswar S',
'Sujithra M',
'Trivedi Nidhi Deepak',
'Bommi Durga Naga Sai Sri Sruthileena',
'Damini H S',
'Gokul Raj R',
'Midhuna Kurian',
'Parkhe Prajwal Anilkumar',
'Praveena B',
'R B Ramyaa',
'Sathishwaran S',
'Vidhyadharan A',
'Yogesh M A',
'B.Tech Admin',
'M.Tech Admin'
   ]
   var photourls =[
'profiles/Aarthi A.JPG',
'profiles/Aishwarya Lakshmi S.JPG',
'profiles/Ajitesh S.JPG',
'profiles/Akash B.JPG',
'profiles/Amirtha Varshini A.JPG',
'profiles/Anandha Keerthy M.JPG',
'profiles/Anindit Bizy Nair.JPG',
'profiles/Anusha R.JPG',
'profiles/Archana P.JPG',
'profiles/Avantika C.JPG',
'profiles/Chandrika Devendrappa.JPG',
'profiles/Chitturi Rohith.JPG',
'profiles/Cubarani Η.JPG',
'profiles/David Evander Jebson S.JPG',
'profiles/Dhanaselvam KR.JPG',
'profiles/Diana Celcia R.JPG',
'profiles/Diya Dharshini S.JPG',
'profiles/Ethaya D.JPG',
'profiles/Gautam Nayak.JPG',
'profiles/Ginu Robtus R.JPG',
'profiles/Guberavishnu S.JPG',
'profiles/Guguloth Sridhar.JPG',
'profiles/Himavanth R.JPG',
'profiles/Jegan P.JPG',
'profiles/Jenish Daniel B.JPG',
'profiles/Joshua Charles.JPG',
'profiles/K Kabilan.JPG',
'profiles/Karyamsetty Worship.JPG',
'profiles/Keerthika P.JPG',
'profiles/Kevin Francis.JPG',
'profiles/Kisha M.JPG',
'profiles/Kota Lakshmi Sanjana.JPG',
'profiles/Lakshmi Narayanan S.JPG',
'profiles/Lakshmi Sruthi L.JPG',
'profiles/Lavudya Sai Kumar.JPG',
'profiles/Mahabir Prasad Swain.JPG',
'profiles/Merla A P.JPG',
'profiles/Mohamed Tharif N J.JPG',
'profiles/Mohannath Shroff J.JPG',
'profiles/MA Monesh Ram.JPG',
'profiles/Mudavath Anjali.JPG',
'profiles/Muthuraja K.JPG',
'profiles/Nitheesh R L.JPG',
'profiles/Nithish J P.JPG',
'profiles/Padmaja M.JPG',
'profiles/Pranav Nanda Kishore.JPG',
'profiles/Punithavathi D.JPG',
'profiles/Rakshithapriya S.JPG',
'profiles/J Sanjeeth.JPG',
'profiles/Santhoshkumar P.JPG',
'profiles/Shivam Jha.JPG',
'profiles/Sivashree .JPG',
'profiles/Sri Harini S.JPG',
'profiles/Srinithi C P.JPG',
'profiles/Srivatsan V.JPG',
'profiles/Subbu Krishna Sharma GM.JPG',
'profiles/Suman Kumar.JPG',
'profiles/Surendar S.JPG',
'profiles/Tippaleti Srujana.JPG',
'profiles/Vemula Uharika.JPG',
'profiles/Vishnu Varthan T.JPG',
'profiles/Yadla Ganesh Babu.JPG',
'profiles/Yuvashreekantham R.JPG',
'profiles/FPT - Anjali S.JPG',
'profiles/FPT - Anshida P K.JPG',
'profiles/FPT - Hari Priya J.JPG',
'profiles/FPT - Harish S.JPG',
'profiles/FPT - Hayanthika M S.JPG',
'profiles/FPT - Irfana Z.JPG',
'profiles/FPT - Kadimi Lakshmi Devi.JPG',
'profiles/FPT - Karthick Ajay B.JPG',
'profiles/FPT - Kolli Venkata Naga Mallikarjuna Reddy.JPG',
'profiles/FPT - Nandana M.JPG',
'profiles/FPT - Shaliha A.JPG',
'profiles/FPT - Sruti Chandra.JPG',
'profiles/FPT - Sushmithasri R.JPG',
'profiles/FSQA - Abhijith K.JPG',
'profiles/FSQA - Ishwarya Lakshmi S.JPG',
'profiles/FSQA - Joseph P J.JPG',
'profiles/FSQA - Mani Bharathi G.JPG',
'profiles/FSQA - Manikandan T.JPG',
'profiles/FSQA - Mathangi G.JPG',
'profiles/FSQA - Mulukuri Naveena.JPG',
'profiles/FSQA - Muthumeena J.JPG',
'profiles/FSQA - Rajasri C.JPG',
'profiles/FSQA - Shanmugapriya R.JPG',
'profiles/FSQA - Srivigneswar S.JPG',
'profiles/FSQA - Sujithra M.JPG',
'profiles/FSQA - Trivedi Nidhi Deepak.JPG',
'profiles/FPE - Bommi Durga Naga Sai Sri Sruthileena.JPG',
'profiles/FPE - Damini H S.JPG',
'profiles/FPE - Gokul Raj R.JPG',
'profiles/FPE - Midhuna Kurian.JPG',
'profiles/FPE - Parkhe Prajwal Anilkumar.JPG',
'profiles/FPE - Praveena B.JPG',
'profiles/FPE - R B Ramyaa.JPG',
'profiles/FPE - Sathishwaran S.JPG',
'profiles/FPE - Vidhyadharan A.JPG',
'profiles/FPE - Yogesh M A.JPG',
'profiles/b.jpeg',
'profiles/b.jpeg'
 ]
var uname ;
for (var i = 0; i < inames.length; i++) {
     uname = localStorage.getItem("loggedname");
     console.log(uname)
     if (uname == inames[i]){
       

   console.log(document.getElementById("profileimage"));
   sessionStorage.setItem("backprofilepic",photourls[i]);
   document.getElementById("profileimage").src = photourls[i];
   document.getElementById("profileimage1").src = photourls[i];
   console.log(document.getElementById("profileimage").src,photourls[i])

     }
   }
   console.log(uname)

   document.getElementById("mname").innerHTML = uname;
   if (uname==undefined){
     alert("You are not logged in. Please log in");
     window.location="../index.html";
   }
   document.getElementById("load").style.display="initial";
           document.getElementById("loader").style.display="block"; 
           document.getElementById("message").textContent = "Fetching requests....";
           function fetchd (){
        console.log("fetch")
        var details ="";
        fetch(
     
     "https://script.google.com/macros/s/AKfycbzQGHS-6Vw0TpWC0vuy9jUfq36kK14reZRUtmz7m9gMgENq-me8hkcOIMg7lDQ09hu5/exec",
     {
       redirect: "follow",
       method: "POST",
       body: uname,
       headers: {
         "Content-Type": "text/plain;charset=utf-8",
       },
     }
    )
    
     .then(function (response) {
    
       // Check if the request was successful
       if (response) {
    
         return response; // Assuming your script returns JSON response
       } else {
         throw new Error("Failed to fetch.");
       }
     })
     .then(async function (data) {
    const result1 = await data.json();
    
    var r = result1.data2[0];
   var userrole =result1.data2[1];
   console.log(r)

    var tabheadsdetail =
    `     <thead>   <th><b>Request ID</b></th>
                      <th class="arp"><b>Status</b></th>
                      <th><b>Resquested Time</b></th>
                      <th><b>Content to be changed</b></th>
                      <th><b>Old Data</b></th>
                      <th><b>New Data</b></th>
                      <th><b>Responded Time</b></th>
                      <th><b>Reason for Decline(if any)</b></th></thead>`
    details += tabheadsdetail
   
   console.log(r);
 
    for(var k=0; k<r.length;k++){

      const searchdata = document.querySelector('.input-group input');
    if(searchdata.value==""){
      var detail = createtable(r[k]);
      details = details + detail;
    }
    else{
var tabledata = r[k].join("");
var tdata =tabledata.toLowerCase();
var sdata =searchdata.value.toLowerCase();
if (tdata.includes(sdata)){
 var detail = createtable(r[k]);
  details = details + detail;
}
    }
    
    function createtable(r){
      var detail ="";
        var head = r[2].split("<br>");
        var olddata = r[3].split("<br>");
        var newdata = r[4].split("<br>");
        var spanno1 = head.length ;
        var spanno = spanno1 -1;
        var formowner="";

        for(var j=1; j<head.length;j++){
          console.log(head.length-1)
          console.log(head)
          console.log(j)

          if (j==head.length-1 && j==1){

                console.log(spanno)
                if(head[j].includes("CV") || head[j].includes("Files")){
              console.log("inn")
              detail += '<tbody class="hoverrowt"><tr class="lasttr"><td rowspan="'+spanno+'">'+r[0]+'</td><td class="statusbar" rowspan="'+spanno+'">'+r[5]+'</td><td rowspan="'+spanno+'">'+r[1]+'</td> <td><b>'+head[j]+'</b></td><td><a class="btn1" href="'+olddata[j]+'" target="_blank">View</a></td><td><a class="btn1" href="'+newdata[j]+'" target="_blank">View</a></td><td rowspan="'+spanno+'">'+r[6]+'</td><td rowspan="'+spanno+'">'+r[7]+'</td> </tr>';
            }

            else{
                detail += '<tbody class="hoverrowt"><tr class="lasttr"><td rowspan="'+spanno+'">'+r[0]+'</td><td class="statusbar" rowspan="'+spanno+'">'+r[5]+'</td><td rowspan="'+spanno+'">'+r[1]+'</td> <td><b>'+head[j]+'</b></td><td>'+olddata[j]+'</td><td>'+newdata[j]+'</td><td rowspan="'+spanno+'">'+r[6]+'</td><td rowspan="'+spanno+'">'+r[7]+'</td> </tr>';
            } 
          }
            else   if (j==1){
                var spanno1 = head.length ;
                var spanno = spanno1 -1;
                console.log(spanno)
                if(head[j].includes("CV") || head[j].includes("Files")){
              console.log("inn")
              detail += '<tbody class="hoverrowt"><tr><td rowspan="'+spanno+'">'+r[0]+'</td><td class="statusbar" rowspan="'+spanno+'">'+r[5]+'</td><td rowspan="'+spanno+'">'+r[1]+'</td> <td><b>'+head[j]+'</b></td><td><a class="btn1" href="'+olddata[j]+'" target="_blank">View</a></td><td><a class="btn1" href="'+newdata[j]+'" target="_blank">View</a></td><td rowspan="'+spanno+'">'+r[6]+'</td><td rowspan="'+spanno+'">'+r[7]+'</td> </tr>';
            }

            else{
                detail += '<tbody class="hoverrowt"><tr><td rowspan="'+spanno+'">'+r[0]+'</td><td class="statusbar" rowspan="'+spanno+'">'+r[5]+'</td><td rowspan="'+spanno+'">'+r[1]+'</td> <td><b>'+head[j]+'</b></td><td>'+olddata[j]+'</td><td>'+newdata[j]+'</td><td rowspan="'+spanno+'">'+r[6]+'</td><td rowspan="'+spanno+'">'+r[7]+'</td> </tr>';
            }
          }
          else if (j==head.length-1){
            var spanno1 = head.length ;
                var spanno = spanno1 -1;
                console.log(spanno)
                if(head[j].includes("CV") || head[j].includes("Files")){
              console.log("inn")
              detail +='<tr class="lasttr"><td><b>'+head[j]+'</b></td> <td><a class="btn1" href="'+olddata[j]+'" target="_blank">View</a></td><td><a class="btn1" href="'+newdata[j]+'" target="_blank">View</a></td></tr></tbody>';
            }

            else{
              detail +='<tr class="lasttr"><td><b>'+head[j]+'</b></td> <td>'+olddata[j]+'</td><td>'+newdata[j]+'</td></tr></tbody>';
            }
                }

            else{
              
            if(head[j].includes("CV") || head[j].includes("Files")){
              console.log("inn")
              detail +='<tr><td><b>'+head[j]+'</b></td> <td><a class="btn1" href="'+olddata[j]+'" target="_blank">View</a></td><td><a class="btn1" href="'+newdata[j]+'" target="_blank">View</a></td></tr>';
            }
    else{
               detail +='<tr><td><b>'+head[j]+'</b></td> <td>'+olddata[j]+'</td><td>'+newdata[j]+'</td></tr>';
    }
            }
        }
        return detail
      }
    console.log(detail)
    console.log(details) 
        
        console.log(details) 
    }
    console.log(details)
    if(statusg!=="keying"){
      console.log(statusg)
    if (r.length!==0){
    document.getElementById("tabdetails").innerHTML = details;
    document.getElementById("tablebee").style.display = "initial";
    }
    else{
      document.getElementById("tablebee").style.display = "none";
        document.getElementById("status").style.display = "initial";
        document.getElementById("status").textContent = "No Past Update Requests";
    }
    document.getElementById("loader").style.display="none"; 
                    document.getElementById("message").textContent = "";
                    document.getElementById("load").style.display = "none";
                  
  } 
    })
    
    .catch(function (error) {
    // Handle errors, you can display an error message here
    console.error(error);
    document.getElementById("loader").style.display="none"; 
    document.getElementById("message").textContent =
    "Failed to fetch.";
    document.getElementById("message").style.display = "block";
    });
       }
      fetchd ();
   
   function approve(){
     var id =  document.getElementById("aid").value;
     id = id.split("/");
     
       console.log(id);
       togglePopup();
       var updatede = id[0]+"/"+"Approve"+"/"+"";
       updatedetails(updatede,id[0],id[1]);
   }
   function decline(){
       var id =  document.getElementById("did").value;
       id = id.split("/");
       var Reason =  document.getElementById("Reason").value;
       console.log(id);
       console.log(Reason);
       if(Reason!==""){
       togglePopup2();
       var updatede = id[0]+"/"+"Decline"+"/"+Reason;
       updatedetails(updatede,id[0],id[1]);
       }
       else{
           alert("Enter the reason for decline")
       }
   }
   function sendmail (name,id){
     
     document.getElementById("load").style.display="initial";
           document.getElementById("loader").style.display="block"; 
           document.getElementById("message").textContent = "Sending Mail to "+name+"...";
           
           
             console.log(id)

   fetch(
    
                 fetchurl,
                 {
                   redirect: "follow",
                   method: "POST",
                   body: id,
                   headers: {
                     "Content-Type": "text/plain;charset=utf-8",
                   },
                 }
               )
       
                 .then(function (response) {
       
                   // Check if the request was successful
                   if (response) {
                
                     return response; // Assuming your script returns JSON response
                   } else {
                     throw new Error("Failed to send the mail.");
                   }
                 })
                 .then(async function (data) {
           const result1 = await data.json();
     
           var r = result1.data2;
   console.log(r);
   if(r == "sent"){
       document.getElementById("loader").style.display="none"; 
                   document.getElementById("message").textContent =
                    "Mail Sent to "+name;
                   document.getElementById("message").style.display = "block";
                   setTimeout(function () { document.getElementById("load").style.display="none"; },2000);
   
                 
   }
   
   
         })
   
         .catch(function (error) {
           // Handle errors, you can display an error message here
           console.error(error);
           document.getElementById("loader").style.display="none"; 
           document.getElementById("message").textContent =
             "Failed to Send the Mail.";
           document.getElementById("message").style.display = "block";
         });
   }
   function updatedetails(updatestring,id,name){
       document.getElementById("load").style.display="initial";
           document.getElementById("loader").style.display="block"; 
           document.getElementById("message").textContent = "Proceesing the request....";
           
       fetch(
    
    "https://script.google.com/macros/s/AKfycbxnl13iMMpRvTpLJW0I5JzGq5jkk4v2f1N7YyjCUVVYAdbrlrLdDjP5Mr517_fG2QOn/exec",
    {
      redirect: "follow",
      method: "POST",
      body: updatestring,
      headers: {
        "Content-Type": "text/plain;charset=utf-8",
      },
    }
   )
   
    .then(function (response) {
   
      // Check if the request was successful
      if (response) {
   
        return response; // Assuming your script returns JSON response
      } else {
        throw new Error("Failed to fetch.");
      }
    })
    .then(async function (data) {
   const result1 = await data.json();
   
   var r = result1.data2;
   console.log(r);
   fetchd ();
   document.getElementById("loader").style.display="none"; 
     document.getElementById("message").textContent = "Processed";
    document.getElementById("message").style.display = "block";
     setTimeout(function () { document.getElementById("load").style.display="none";
   sendmail (name,id);
   
   },2000);
   
   })
   
   .catch(function (error) {
   // Handle errors, you can display an error message here
   console.error(error);
   document.getElementById("loader").style.display="none"; 
   document.getElementById("message").textContent =
   "Failed to fetch.";
   document.getElementById("message").style.display = "block";
   });
   }
   </script>
    <script>
      function updatelogstatus(status){
        var updatestring = localStorage.getItem("loggedname")+"/"+status;
   
             
         fetch(
      
      "https://script.google.com/macros/s/AKfycbxEoNGPxEXxwtSXqRvPhgGK_btTmbVO4Tq6ZW002Q7Olap6cyoi5hmNAwYTS3OfLJCLug/exec",
      {
        redirect: "follow",
        method: "POST",
        body: updatestring,
        headers: {
          "Content-Type": "text/plain;charset=utf-8",
        },
      }
     )
     
      .then(function (response) {
     
        // Check if the request was successful
        if (response) {
     
          return response; // Assuming your script returns JSON response
        } else {
          throw new Error("Failed to fetch.");
        }
      })
      .then(async function (data) {
     const result1 = await data.json();
     
     var r = result1.data2;
    
     
     })
     
     .catch(function (error) {
     // Handle errors, you can display an error message here
     console.error(error);
  
     });
     }
     setInterval(() => {
  
  fetchd ();
  }, 1000)
  
  setTimeout(() => {
  
  updatelogstatus("Online");
  
  }, 2000)
  window.addEventListener("blur", () => {
    updatelogstatus("Offline");   
    });
    window.addEventListener("focus", () => {
    updatelogstatus("Online");   
    });
  //window.unblur = colse();
  const beforeUnloadHandler = (event) => {  
    updatelogstatus("Offline");  
  };
  window.addEventListener("beforeunload", beforeUnloadHandler);
     </script>

</html>